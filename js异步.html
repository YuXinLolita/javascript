<!DOCTYPE html>
<html>

<head>
    <title>异步</title>
</head>

<body>

</body>
<script>
    //callback hell 回调地狱
    //获取第一份数据
    $.get(url1, (data1) => {
        console.log(data1)
        //获取第二份数据
        $.get(url2, (data2) => {
            console.log(data2)
            //获取第二份数据
            $.get(url3, (data3) => {
                console.log(data3)
                //还可能获取更多的数据
            })
        })
    })
    //Promise
    function getData(url) {
        return new Promise((resolve, reject) => {
            $.ajax({
                url,
                success(data) {
                    resolve(data)
                },
                error(err) {
                    reject(err)
                }
            })
        })
    }

    const url1 = '/data1.json'
    const url2 = '/data1.json'
    const url3 = '/data1.json'
    getData(url1).then(data1 => {
        console.log(data1)
        return getData(url2)
    }).then(data2 => {
        console.log(data2)
        return getData(url3)
    }).then(data3 => {
        console.log(data3)
    }).catch(err => console.errorerr(err))
    //ajax
    console.log('start')
    $.get('./data1.jspn', function (data1) {
        console.log(data1)
    }
    )
    console.log('end')
    //图片加载
    console.log('start')
    let img = document.createElement(('img'))
    img.onload = function () {
        console.log('loaded')
    }
    img.src = '/xxx.png'
    console.log('end')
    //定时器 setInterval
    console.log(100)
    setInterval(function () {
        console.log(200)
    }, 1000)
    console.log(300)
    //settimeout
    console.log(100)
    setTimeout(function () {
        console.log(200)
    }, 1000)
    console.log(300)
cosnle.log(100) //異步
setTimeout(() => {
    console.log( 200)
}, 1000)
console.log( 300 )
console.log(100)//同步
alert(200)
console.log(300)
//加载图片
const url = 'https://img2.baidu.com/it/u=3383150885,184381380&fm=253&fmt=auto&app=138&f=JPEG?w=339&h=337'
function loadImg(src) {
    const p = new Promise(
        (resolve, reject) => {
            const img = document.createElement('img')
            img.onload = () => {
                resolve(img)
            }
            img.onerror = () => {
                const err = new ERRor(`图片加载失败 ${src}` )
                reject(err)
            }
            img.src = src
        }
    )
    return p
}
loadImg(url).then( img => {
    console.log(img.width)
    return img
}).then(img => {
    console.log(img.height)
}).catch(ex => console.log(ex))
 const url2 = 'https://img1.baidu.com/it/u=981030981,901082342&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=676'
 loadImg(url1).then(img1 => {
    console.log(img1.width)
    return img1 //普通对象
 }).then(img1 => {
    conosle.log(img1.height)
    return loadImg(url2) //promise实例
 }).then(img2 => {
    console.log(img2.width)
    return img2
 }).then(img2 => {
    console.log(img2.height)
 }).catch(ex => console.log(ex))
 //settimeout笔试题
 console.log(1)
 setTimeout(function () {
    console.log(2)
 },1000)
 console.log(3)
 setTimeout(function() {
    console.log(4)
 }, 0)
 console.log(5)
</script>
</html>